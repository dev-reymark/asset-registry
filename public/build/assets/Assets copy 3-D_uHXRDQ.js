import{K as He,r as a,j as e,L as $e,$ as Ke,S as m,V as D}from"./app-aY9BIasm.js";import{A as Ye}from"./Authenticated-Cs3IKyfD.js";import{u as Be}from"./useDebounce-Z9e_rSSZ.js";import{C as Ge}from"./index-C4A7g0qo.js";import{s as c}from"./index-Bh_4CRB_.js";import{F as ke}from"./swiper-x0t-193g.js";import{S as Je,a as Qe}from"./swiper-react-BecIza9L.js";import{H as We,t as le}from"./index-P8yRFWsj.js";import{i as Xe}from"./chunk-3TCFMHK3-NAXG3gvF.js";import{u as w,m as F,a as L,b as P,c as R,d as M}from"./index-d_PQ_Off.js";import{i as U}from"./chunk-5CAICSBD-Bon_4Db9.js";import{d as ie,a as oe,b as ce,m as C}from"./chunk-Z2IJA2C6-BVMs3wHl.js";import{b as r}from"./chunk-KCYYJJH4-CuIDxtRT.js";import{t as Ze,a as es,b as n,c as ss,d as ts,e as l}from"./chunk-F3UDT23P-CUWipdL-.js";import{c as as}from"./chunk-J7I6W5JF-Bpnv0ezb.js";import{s as z,l as q}from"./chunk-2C6KNKEU-DdyrKsnr.js";import"./index-D8JALEir.js";import"./useMenuTriggerState-XZAtU0B5.js";import"./index-asNM_JKk.js";import"./chunk-SLABUSGS-Bl3byEtu.js";import"./LiveAnnouncer-B6gXhWJp.js";const rs={Active:"success",Defective:"danger","For Aquisition":"warning","For Repair":"secondary","For Replacement":"primary",Archived:"default"},de=[{label:"Active",value:"Active"},{label:"Defective",value:"Defective"},{label:"For Aquisition",value:"For Aquisition"},{label:"For Repair",value:"For Repair"},{label:"For Replacement",value:"For Replacement"}];function ys(){const{assets:ue,location:he,title:me,desc:pe,filters:i={},descriptions:xe,statuses:fe,issuedTos:je}=He().props,[S,V]=a.useState(i.search||""),[d,Se]=a.useState(i.sort||""),[g,H]=a.useState(i.start_date||""),[v,$]=a.useState(i.end_date||""),[K,ge]=a.useState(i.description||""),[Y,ve]=a.useState(i.status||""),[B,_e]=a.useState(i.issued_to||""),[Ae,ns]=a.useState(i.sort_field||""),[be,ls]=a.useState(i.sort_direction||""),{isOpen:Ne,onOpen:De,onOpenChange:Ce}=w(),[o,O]=a.useState(null),[_,T]=a.useState(new Set),[G,k]=a.useState(""),A=(t,s)=>{m.get(c("assets.index"),{search:S,sort:d,start_date:t,end_date:s},{preserveState:!0,replace:!0})},Oe=t=>{const s=t.target.value;H(s),A(s,v)},Te=t=>{const s=t.target.value;$(s),A(g,s)},ye=Be(t=>{m.get(c("assets.index"),{search:t,sort:d},{preserveState:!0,replace:!0})},300),Ee=t=>{const s=t.target.value;V(s),ye(s)},Ie=()=>{V(""),m.get(c("assets.index"),{search:"",sort:d})},we=()=>{const t=d==="name_asc"?"name_desc":"name_asc";Se(t),m.get(c("assets.index"),{search:S,sort:t},{preserveState:!0,replace:!0})},Fe=t=>{m.get(c("assets.index"),{search:S,sortField:Ae,sortDirection:be,start_date:g,end_date:v,description:K,status:Y,issued_to:B,...t},{preserveState:!0,replace:!0})},{isOpen:Le,onOpen:Pe,onOpenChange:Re}=w(),[y,J]=a.useState(""),[Q,W]=a.useState(!1),Me=(t,s)=>{const u=t.map(Number);W(!0),m.post(c("assetsextended.transfer"),{asset_nos:u,location_id:s,status:G},{preserveState:!0,replace:!0,onSuccess:()=>{T(new Set),J(""),k(""),D.success("Assets transferred successfully.")},onError:h=>{console.error("Transfer failed:",h),D.error("Failed to transfer assets.")},onFinish:()=>{W(!1)}})},{isOpen:Ue,onOpen:ze,onOpenChange:qe}=w(),[E,X]=a.useState(""),[I,Z]=a.useState(""),[ee,se]=a.useState(!1),[te,ae]=a.useState(""),Ve=t=>{se(!0);const s=t.map(Number);m.post(c("assetsextended.archive",{assetNo:s}),{status:te,archival_reason:E,conditions:I},{preserveState:!0,replace:!0,onSuccess:()=>{T(new Set),ae(""),X(""),Z(""),D.success("Assets archived successfully.")},onError:u=>{console.error("Archive failed:",u),D.error("Failed to archive assets.")},onFinish:()=>{se(!1)}})};return e.jsxs(Ye,{children:[e.jsx($e,{title:"Employee Assets"}),e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:me}),e.jsx("p",{className:"text-gray-600 mb-4",children:pe}),e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx(U,{isClearable:!0,className:"w-full sm:max-w-[44%]",placeholder:"Search by name, description...",startContent:e.jsx(Ge,{className:"size-5"}),value:S,onClear:Ie,onChange:Ee}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ke,{statuses:fe,status:Y,setStatus:ve,descriptions:xe,description:K,setDescription:ge,issuedTos:je,issuedTo:B,applyFilters:Fe,setIssuedTo:_e}),e.jsxs(ie,{children:[e.jsx(oe,{children:e.jsx(r,{variant:"bordered",children:"Filter by Date Issued"})}),e.jsx(ce,{"aria-label":"Filter by Date Issued",className:"p-2 w-72",closeOnSelect:!1,children:e.jsx(C,{className:"cursor-default",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(U,{type:"date",label:"Start Date",value:g,onChange:Oe}),e.jsx(U,{type:"date",label:"End Date",value:v,onChange:Te}),e.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[e.jsx(r,{color:"primary",onPress:()=>A(g,v),children:"Apply"}),e.jsx(r,{color:"warning",variant:"flat",onPress:()=>{H(""),$(""),A("","")},children:"Clear"})]})]})},"filter")})]})]})]}),e.jsxs(Ze,{isVirtualized:!0,selectionMode:"multiple",selectedKeys:_,onSelectionChange:T,"aria-label":"Employee Assets table",isStriped:!0,topContent:e.jsxs("div",{className:"flex justify-start items-center mb-4 gap-2",children:[e.jsx(r,{color:"primary",as:Ke,href:c("assetsextended.create"),children:"Add New Asset"}),e.jsx(r,{color:"success",variant:"flat",onPress:Pe,isDisabled:_.size===0,children:"Transfer Asset"})]}),children:[e.jsxs(es,{children:[e.jsx(n,{children:"Asset #"}),e.jsx(n,{children:"System Asset ID"}),e.jsx(n,{children:"Description"}),e.jsx(n,{children:"Model"}),e.jsx(n,{children:"Serial No"}),e.jsxs(n,{onClick:we,style:{cursor:"pointer"},children:["EMPLOYEE",d==="name_asc"&&" 🔼",d==="name_desc"&&" 🔽",!["name_asc","name_desc"].includes(d)&&" ⏺️"]}),e.jsx(n,{children:"Location"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"Date Issued"}),e.jsx(n,{children:"Actions"})]}),e.jsx(ss,{emptyContent:"No rows to display.",children:ue.map(t=>t.asset_details.map((s,u)=>{var h,p,x,f,b,j,N,re,ne;return e.jsxs(ts,{children:[e.jsx(l,{children:(h=s.ASSETNUMBER)==null?void 0:h.trim()}),e.jsx(l,{children:(p=s.SYSTEMASSETID)==null?void 0:p.trim()}),e.jsx(l,{children:(x=s.DESCRIPTION)==null?void 0:x.trim()}),e.jsx(l,{children:(f=s.MODEL)==null?void 0:f.trim()}),e.jsx(l,{children:(b=s.SERIALNO)==null?void 0:b.trim()}),e.jsx(l,{children:(j=t.EMPLOYEENAME)==null?void 0:j.trim()}),e.jsx(l,{children:(N=s==null?void 0:s.location.LOCATIONNAME)==null?void 0:N.trim()}),e.jsx(l,{children:e.jsx(as,{variant:"flat",color:rs[(re=s.STATUS)==null?void 0:re.trim()]||"default",radius:"md",children:(ne=s.STATUS)==null?void 0:ne.trim()})}),e.jsx(l,{children:s.DATEISSUUED?new Date(s.DATEISSUUED.trim()).toLocaleDateString():"--"}),e.jsx(l,{children:e.jsxs(ie,{children:[e.jsx(oe,{children:e.jsx(r,{isIconOnly:!0,size:"sm",variant:"light",children:e.jsx(We,{size:20,className:"text-default-800"})})}),e.jsxs(ce,{children:[e.jsx(C,{onPress:()=>{O({...t,asset_details:[s]}),De()},children:"View"},"view"),e.jsx(C,{children:"Update"},"update"),e.jsx(C,{className:"text-danger",color:"danger",onPress:()=>{O({...t,asset_details:[s]}),ze()},children:"Dispose"},"dispose")]})]})})]},s.ASSETNO)}))})]}),e.jsx(F,{isOpen:Ne,size:"xl",placement:"top-center",onOpenChange:t=>{t||O(null),Ce(t)},children:e.jsx(L,{children:t=>{var s,u,h,p,x,f;return e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"flex flex-col gap-1",children:"Assets Details"}),e.jsx(R,{children:o&&e.jsxs("div",{className:"flex flex-wrap gap-6",children:[e.jsx(Je,{spaceBetween:10,slidesPerView:1,className:"w-full sm:w-1/2 lg:w-1/3",children:((s=o==null?void 0:o.asset_details[0])==null?void 0:s.IMAGEPATH)&&JSON.parse(o.asset_details[0].IMAGEPATH).map((b,j)=>e.jsx(Qe,{children:e.jsx(Xe,{src:`/storage/${b}`,alt:`Asset Image ${j+1}`,className:"object-cover",width:400,height:200,onError:N=>N.target.src="/assets/placeholder.jpg"})},j))}),e.jsxs("div",{className:"flex-1 space-y-4 text-sm text-gray-700",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Description:"})," ",(u=o.asset_details[0])==null?void 0:u.DESCRIPTION]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Serial Number:"})," ",(h=o.asset_details[0])==null?void 0:h.SERIALNO]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Date Issued:"})," ",(x=(p=o.asset_details[0])==null?void 0:p.DATEISSUUED)==null?void 0:x.trim()]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Condition:"})," ",(f=o.asset_details[0])==null?void 0:f.CONDITIONS]})]})]})}),e.jsx(M,{children:e.jsx(r,{color:"danger",variant:"flat",onPress:t,children:"Close"})})]})}})}),e.jsx(F,{isOpen:Le,onOpenChange:Re,size:"md",placement:"top-center",children:e.jsx(L,{children:t=>e.jsxs(e.Fragment,{children:[e.jsxs(P,{className:"flex flex-col gap-1",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Transfer Assets"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Select a location to transfer the selected assets."})]}),e.jsxs(R,{children:[e.jsx(z,{label:"Select Location",value:y,onChange:s=>J(s.target.value),children:he.map(s=>e.jsx(q,{value:s.LOCATIONID,children:s.LOCATIONNAME},s.LOCATIONID))}),e.jsx(z,{label:"Select Status",value:G,onChange:s=>k(s.target.value),children:de.map(s=>e.jsx(q,{value:s.value,children:s.label},s.value))})]}),e.jsxs(M,{children:[e.jsx(r,{color:"danger",variant:"light",onPress:t,children:"Cancel"}),e.jsx(r,{color:"primary",onPress:()=>{Me(Array.from(_),y),t()},isDisabled:!y,isLoading:Q,children:Q?"Transferring...":"Transfer"})]})]})})}),e.jsx(F,{isOpen:Ue,onOpenChange:qe,placement:"top-center",children:e.jsx(L,{children:t=>e.jsxs(e.Fragment,{children:[e.jsxs(P,{className:"flex flex-col gap-1",children:[e.jsx("h1",{className:"text-lg font-semibold text-danger-500",children:"Are you sure you want to dispose?"}),e.jsxs(R,{className:"",children:[e.jsx(le,{isRequired:!0,label:"Reason for disposal",value:E,onChange:s=>X(s.target.value)}),e.jsx(z,{isRequired:!0,variant:"faded",label:"Select Status",value:te,onChange:s=>ae(s.target.value),children:de.map(s=>e.jsx(q,{value:s.value,children:s.label},s.value))}),e.jsx(le,{variant:"faded",isRequired:!0,label:"Asset Condition",value:I,onChange:s=>Z(s.target.value)})]})]}),e.jsxs(M,{children:[e.jsx(r,{color:"danger",variant:"light",onPress:t,children:"Cancel"}),e.jsx(r,{color:"primary",onPress:()=>{Ve(Array.from(_)),t()},isDisabled:!E||!I,isLoading:ee,children:ee?"Disposing...":"Dispose"})]})]})})})]})]})}export{ys as default};
