import{r as n,t as P,a as U,a5 as S,Z as k,g as N,j as I}from"./app-saVGxy0N.js";function _(...e){return e.length===1&&e[0]?e[0]:a=>{for(let t of e)typeof t=="function"?t(a):t!=null&&(t.current=a)}}function q(e){const a=n.useRef(null);return n.useMemo(()=>({get current(){return a.current},set current(t){a.current=t,typeof e=="function"?e(t):e&&(e.current=t)}}),[e])}function te(e,a,t){let[l,d]=n.useState(e||a),i=n.useRef(e!==void 0),o=e!==void 0;n.useEffect(()=>{let r=i.current;r!==o&&console.warn(`WARN: A component changed from ${r?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}.`),i.current=o},[o]);let u=o?e:l,s=n.useCallback((r,...c)=>{let v=(m,...$)=>{t&&(Object.is(u,m)||t(m,...$)),o||(u=m)};typeof r=="function"?(console.warn("We can not support a function callback. See Github Issues for details https://github.com/adobe/react-spectrum/issues/2320"),d(($,...V)=>{let b=r(o?u:$,...V);return v(b,...c),o?$:b})):(o||d(r),v(r,...c))},[o,u,t]);return[u,s]}var Q=P({base:"flex flex-col gap-2 items-start"});const F={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},R={...F,customError:!0,valid:!1},y={isInvalid:!1,validationDetails:F,validationErrors:[]},O=n.createContext({}),w="__formValidationState"+Date.now();function ae(e){if(e[w]){let{realtimeValidation:a,displayValidation:t,updateValidation:l,resetValidation:d,commitValidation:i}=e[w];return{realtimeValidation:a,displayValidation:t,updateValidation:l,resetValidation:d,commitValidation:i}}return W(e)}function W(e){let{isInvalid:a,validationState:t,name:l,value:d,builtinValidation:i,validate:o,validationBehavior:u="aria"}=e;t&&(a||(a=t==="invalid"));let s=a!==void 0?{isInvalid:a,validationErrors:[],validationDetails:R}:null,r=n.useMemo(()=>{if(!o||d==null)return null;let f=G(o,d);return A(f)},[o,d]);i!=null&&i.validationDetails.valid&&(i=void 0);let c=n.useContext(O),v=n.useMemo(()=>l?Array.isArray(l)?l.flatMap(f=>C(c[f])):C(c[l]):[],[c,l]),[m,$]=n.useState(c),[V,b]=n.useState(!1);c!==m&&($(c),b(!1));let E=n.useMemo(()=>A(V?[]:v),[V,v]),L=n.useRef(y),[x,h]=n.useState(y),p=n.useRef(y),T=()=>{if(!B)return;g(!1);let f=r||i||L.current;M(f,p.current)||(p.current=f,h(f))},[B,g]=n.useState(!1);return n.useEffect(T),{realtimeValidation:s||E||r||i||y,displayValidation:u==="native"?s||E||x:s||E||r||i||x,updateValidation(f){u==="aria"&&!M(x,f)?h(f):L.current=f},resetValidation(){let f=y;M(f,p.current)||(p.current=f,h(f)),u==="native"&&g(!1),b(!0)},commitValidation(){u==="native"&&g(!0),b(!0)}}}function C(e){return e?Array.isArray(e)?e:[e]:[]}function G(e,a){if(typeof e=="function"){let t=e(a);if(t&&typeof t!="boolean")return C(t)}return[]}function A(e){return e.length?{isInvalid:!0,validationErrors:e,validationDetails:R}:null}function M(e,a){return e===a?!0:!!e&&!!a&&e.isInvalid===a.isInvalid&&e.validationErrors.length===a.validationErrors.length&&e.validationErrors.every((t,l)=>t===a.validationErrors[l])&&Object.entries(e.validationDetails).every(([t,l])=>a.validationDetails[t]===l)}function ie(e,a,t){let{validationBehavior:l,focus:d}=e;U(()=>{if(l==="native"&&(t!=null&&t.current)&&!t.current.disabled){let s=a.realtimeValidation.isInvalid?a.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";t.current.setCustomValidity(s),t.current.hasAttribute("title")||(t.current.title=""),a.realtimeValidation.isInvalid||a.updateValidation(Y(t.current))}});let i=S(()=>{a.resetValidation()}),o=S(s=>{var r;a.displayValidation.isInvalid||a.commitValidation();let c=t==null||(r=t.current)===null||r===void 0?void 0:r.form;if(!s.defaultPrevented&&t&&c&&Z(c)===t.current){var v;d?d():(v=t.current)===null||v===void 0||v.focus(),k("keyboard")}s.preventDefault()}),u=S(()=>{a.commitValidation()});n.useEffect(()=>{let s=t==null?void 0:t.current;if(!s)return;let r=s.form;return s.addEventListener("invalid",o),s.addEventListener("change",u),r==null||r.addEventListener("reset",i),()=>{s.removeEventListener("invalid",o),s.removeEventListener("change",u),r==null||r.removeEventListener("reset",i)}},[t,o,u,i,l])}function K(e){let a=e.validity;return{badInput:a.badInput,customError:a.customError,patternMismatch:a.patternMismatch,rangeOverflow:a.rangeOverflow,rangeUnderflow:a.rangeUnderflow,stepMismatch:a.stepMismatch,tooLong:a.tooLong,tooShort:a.tooShort,typeMismatch:a.typeMismatch,valueMissing:a.valueMissing,valid:a.valid}}function Y(e){return{isInvalid:!e.validity.valid,validationDetails:K(e),validationErrors:e.validationMessage?[e.validationMessage]:[]}}function Z(e){for(let a=0;a<e.elements.length;a++){let t=e.elements[a];if(!t.validity.valid)return t}return null}var j=Symbol("default");function z(e,a){let t=n.useContext(e);if(a===null)return null;if(t&&typeof t=="object"&&"slots"in t&&t.slots){let l=new Intl.ListFormat().format(Object.keys(t.slots).map(i=>`"${i}"`));if(!a&&!t.slots[j])throw new Error(`A slot prop is required. Valid slot names are ${l}.`);let d=a||j;if(!t.slots[d])throw new Error(`Invalid slot "${a}". Valid slot names are ${l}.`);return t.slots[d]}return t}function H(e,a,t){let l=z(t,e.slot)||{},{ref:d,...i}=l,o=q(n.useMemo(()=>_(a,d),[a,d])),u=N(i,e);return"style"in i&&i.style&&"style"in e&&e.style&&(typeof i.style=="function"||typeof e.style=="function"?u.style=s=>{let r=typeof i.style=="function"?i.style(s):i.style,c={...s.defaultStyle,...r},v=typeof e.style=="function"?e.style({...s,defaultStyle:c}):e.style;return{...c,...v}}:u.style={...i.style,...e.style}),[u,o]}var D=n.createContext(null),le=n.forwardRef(function(a,t){[a,t]=H(a,t,D);let{validationErrors:l,validationBehavior:d="native",children:i,className:o,...u}=a;const s=n.useMemo(()=>Q({className:o}),[o]);return I.jsx("form",{noValidate:d!=="native",...u,ref:t,className:s,children:I.jsx(D.Provider,{value:{...a,validationBehavior:d},children:I.jsx(O.Provider,{value:l??{},children:i})})})});export{te as $,D as F,ae as a,w as b,_ as c,le as d,ie as e,y as f,z as u};
