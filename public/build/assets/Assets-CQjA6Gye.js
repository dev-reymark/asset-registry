import{j as e,K as es,r as i,L as ss,$ as je,S as b,V as O}from"./app-D2Fc9J7r.js";import{A as ts,M as as}from"./Authenticated-Bi7dy8wc.js";import{u as rs}from"./useDebounce-BQOWSoNW.js";import{C as ns}from"./index-BygZJprX.js";import{G as Ne,s as v}from"./index-KE12rTfI.js";import{F as ls}from"./swiper-BOcsf77U.js";import{t as Se,H as is}from"./index-yk3UxgDN.js";import{A as os}from"./AssetComponents-7oNtlmOB.js";import{s as cs,n as q}from"./statusConstants-B9bmVMgg.js";import{S as ds,a as hs}from"./swiper-react-Dkamn6yS.js";import{m as U,a as V,b as Y,c as H,d as B,u as T}from"./index-DipQ1G8P.js";import{i as us}from"./chunk-3TCFMHK3-LtiDXk4l.js";import{b as d}from"./chunk-KCYYJJH4-CFnQEN56.js";import{s as A,l as C}from"./chunk-2C6KNKEU-DB-baBfx.js";import{i as K}from"./chunk-5CAICSBD-C5uePlKw.js";import{d as ge,a as ve,b as _e,m as z}from"./chunk-Z2IJA2C6-BuKxO1iJ.js";import{b as xs}from"./chunk-57V4RE7B-zT8ZG2YL.js";import{t as ps,a as ms,b as _,c as fs,d as js,e as N}from"./chunk-F3UDT23P-DI8xBlRF.js";import{c as Ss}from"./chunk-J7I6W5JF-CLLlUbvt.js";import"./useMenuTriggerState-BWe6aKPw.js";import"./index-K8Flc6f-.js";import"./chunk-SLABUSGS-BiRJdjsi.js";import"./index-CbNZw6my.js";import"./LiveAnnouncer-BVsrsiec.js";const gs=({isOpen:h,selectedAsset:l,onOpenChange:j,onComponentModalOpen:f})=>e.jsx(U,{isOpen:h,size:"xl",placement:"top-center",onOpenChange:j,children:e.jsx(V,{children:m=>{var o,u,S,g,x,p;return e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"flex flex-col gap-1",children:"Assets Details"}),e.jsx(H,{children:l&&e.jsxs("div",{className:"flex flex-wrap gap-6",children:[e.jsx(ds,{spaceBetween:10,slidesPerView:1,className:"w-full sm:w-1/2 lg:w-1/3",children:((o=l==null?void 0:l.asset_details[0])==null?void 0:o.IMAGEPATH)&&JSON.parse(l.asset_details[0].IMAGEPATH).map((c,r)=>e.jsx(hs,{children:e.jsx(us,{src:`/storage/${c}`,alt:`Asset Image ${r+1}`,className:"object-cover",width:400,height:200,onError:n=>n.target.src="/assets/placeholder.jpg"})},r))}),e.jsxs("div",{className:"flex-1 space-y-4 text-sm text-gray-700",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Description:"})," ",(u=l.asset_details[0])==null?void 0:u.DESCRIPTION]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Serial Number:"})," ",(S=l.asset_details[0])==null?void 0:S.SERIALNO]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Date Issued:"})," ",(x=(g=l.asset_details[0])==null?void 0:g.DATEISSUUED)==null?void 0:x.trim()]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Condition:"})," ",(p=l.asset_details[0])==null?void 0:p.CONDITIONS]}),e.jsx(d,{color:"primary",variant:"light",onPress:f,children:"View components"})]})]})}),e.jsx(B,{children:e.jsx(d,{color:"danger",variant:"flat",onPress:m,children:"Close"})})]})}})}),vs=({isTransferOpen:h,onTransferOpenChange:l,employees:j,location:f,selectedEmployeeId:m,setSelectedEmployeeId:o,selectedLocationId:u,setSelectedLocationId:S,statusToTransfer:g,setStatusToTransfer:x,newStatus:p,selectedKeys:c,handleTransferAssets:r,loading:n})=>e.jsx(U,{isOpen:h,onOpenChange:l,children:e.jsx(V,{children:E=>e.jsxs(e.Fragment,{children:[e.jsxs(Y,{className:"flex flex-col gap-1",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Transfer Assets"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Select a location, employee and status to transfer the selected assets."})]}),e.jsxs(H,{children:[e.jsx(A,{label:"Select Employee",value:m,onChange:a=>o(a.target.value),children:j.map((a,G)=>a.EMPLOYEEID?e.jsx(C,{value:a.EMPLOYEEID,children:a.EMPLOYEENAME},a.EMPLOYEEID):null)}),e.jsx(A,{label:"Select Location",value:u,onChange:a=>S(a.target.value),children:f.map(a=>e.jsx(C,{value:a.LOCATIONID,children:a.LOCATIONNAME},a.LOCATIONID))}),e.jsx(A,{label:"Select Status",value:g,onChange:a=>x(a.target.value),children:p.map(a=>e.jsx(C,{value:a.value,children:a.label},a.value))})]}),e.jsxs(B,{children:[e.jsx(d,{color:"danger",variant:"light",onPress:E,children:"Cancel"}),e.jsx(d,{color:"primary",onPress:()=>{r(Array.from(c),u,m),E()},isDisabled:!u||!m,isLoading:n,children:n?"Transferring...":"Transfer"})]})]})})}),_s=({isArchiveOpen:h,onArchiveOpenChange:l,statusToArchive:j,setStatusToArchive:f,reason:m,setReason:o,condition:u,setCondition:S,handleArchiveAssets:g,selectedAsset:x,archiveLoading:p,newStatus:c})=>e.jsx(U,{isOpen:h,onOpenChange:l,placement:"top-center",children:e.jsx(V,{children:r=>e.jsxs(e.Fragment,{children:[e.jsxs(Y,{className:"flex flex-col gap-1",children:[e.jsx("h1",{className:"text-lg font-semibold text-danger-500",children:"Are you sure you want to dispose?"}),e.jsxs(H,{className:"",children:[e.jsx(Se,{isRequired:!0,label:"Reason for disposal",value:m,onChange:n=>o(n.target.value)}),e.jsx(A,{isRequired:!0,variant:"faded",label:"Select Status",value:j,onChange:n=>f(n.target.value),children:c.map(n=>e.jsx(C,{value:n.value,children:n.label},n.value))}),e.jsx(Se,{variant:"faded",isRequired:!0,label:"Asset Condition",value:u,onChange:n=>S(n.target.value)})]})]}),e.jsxs(B,{children:[e.jsx(d,{color:"danger",variant:"light",onPress:r,children:"Cancel"}),e.jsx(d,{color:"primary",onPress:()=>{g(x.asset_details.map(n=>n.ASSETNO)),r()},isDisabled:!m||!u,isLoading:p,children:p?"Disposing...":"Dispose"})]})]})})}),Ns=({location:h,selectedLocationId:l,setSelectedLocationId:j,statusToTransfer:f,setStatusToTransfer:m,newStatus:o,selectedKeys:u,isDeclassificationOpen:S,onDeclassificationOpenChange:g,handleDeclassification:x,loading:p})=>e.jsx(U,{isOpen:S,onOpenChange:g,children:e.jsx(V,{children:c=>e.jsxs(e.Fragment,{children:[e.jsxs(Y,{className:"flex flex-col gap-1",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Declassify Assets"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Select a location and status to declassify the selected assets."})]}),e.jsxs(H,{children:[e.jsx(A,{label:"Select Location",value:l,onChange:r=>j(r.target.value),children:h.map(r=>e.jsx(C,{value:r.LOCATIONID,children:r.LOCATIONNAME},r.LOCATIONID))}),e.jsx(A,{label:"Select Status",value:f,onChange:r=>m(r.target.value),children:o.map(r=>e.jsx(C,{value:r.value,children:r.label},r.value))})]}),e.jsxs(B,{children:[e.jsx(d,{color:"danger",variant:"light",onPress:c,children:"Cancel"}),e.jsx(d,{color:"primary",onPress:()=>{x(Array.from(u),l),c()},isDisabled:!l||!f,isLoading:p,children:p?"Declassifying...":"Declassify"})]})]})})});function bs(h){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 14 20 9 15 4"},child:[]},{tag:"path",attr:{d:"M4 20v-7a4 4 0 0 1 4-4h12"},child:[]}]})(h)}function Ds(h){return Ne({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"},child:[]},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]}]})(h)}function Xs(){const{employees:h,assets:l,location:j,title:f,desc:m,filters:o={},descriptions:u,statuses:S,issuedTos:g}=es().props,[x,p]=i.useState(o.search||""),[c,r]=i.useState(o.sort||""),[n,E]=i.useState(o.start_date||""),[a,G]=i.useState(o.end_date||""),[W,be]=i.useState(o.description||""),[J,De]=i.useState(o.status||""),[Q,Oe]=i.useState(o.issued_to||""),[Ae,Os]=i.useState(o.sort_field||""),[Ce,As]=i.useState(o.sort_direction||""),{isOpen:Ee,onOpen:ye,onOpenChange:Te}=T(),[$,X]=i.useState(null),[y,I]=i.useState(new Set),[w,L]=i.useState(""),M=(t,s)=>{b.get(v("assets.index"),{search:x,sort:c,start_date:t,end_date:s},{preserveState:!0,replace:!0})},Ie=t=>{const s=t.target.value;E(s),M(s,a)},we=t=>{const s=t.target.value;G(s),M(n,s)},Le=rs(t=>{b.get(v("assets.index"),{search:t,sort:c},{preserveState:!0,replace:!0})},300),Me=t=>{const s=t.target.value;p(s),Le(s)},Pe=()=>{p(""),b.get(v("assets.index"),{search:"",sort:c})},Fe=()=>{const t=c==="name_asc"?"name_desc":"name_asc";r(t),b.get(v("assets.index"),{search:x,sort:t},{preserveState:!0,replace:!0})},Re=t=>{b.get(v("assets.index"),{search:x,sortField:Ae,sortDirection:Ce,start_date:n,end_date:a,description:W,status:J,issued_to:Q,...t},{preserveState:!0,replace:!0})},{isOpen:ke,onOpen:ze,onOpenChange:Ue}=T(),{isOpen:Ve,onOpen:Ye,onOpenChange:He}=T(),[Z,P]=i.useState(""),[ee,F]=i.useState(!1),[Be,se]=i.useState(""),Ge=(t,s,R)=>{const D=t.map(Number);F(!0),b.post(v("assetsextended.transfer"),{asset_nos:D,location_id:s,employee_id:R,status:w},{preserveState:!0,replace:!0,onSuccess:()=>{I(new Set),P(""),se(""),L(""),O.success("Assets transferred successfully.")},onError:k=>{console.error("Transfer failed:",k),O.error("Failed to transfer assets.")},onFinish:()=>{F(!1)}})},$e=(t,s)=>{const R=t.map(Number);F(!0),b.post(v("assetsextended.declassify"),{asset_nos:R,location_id:s,status:w},{preserveState:!0,replace:!0,onSuccess:()=>{I(new Set),P(""),L(""),O.success("Assets transferred successfully.")},onError:D=>{console.error("Transfer failed:",D),O.error("Failed to transfer assets.")},onFinish:()=>{F(!1)}})},{isOpen:qe,onOpen:Ke,onOpenChange:We}=T(),[te,ae]=i.useState(""),[re,ne]=i.useState(""),[le,ie]=i.useState(!1),[oe,ce]=i.useState(""),Je=t=>{ie(!0),b.post(v("assetsextended.archive",{assetNo:t}),{status:oe,archival_reason:te,conditions:re},{preserveState:!0,replace:!0,onSuccess:()=>{I(new Set),ce(""),ae(""),ne(""),O.success("Assets archived successfully.")},onError:s=>{console.error("Archive failed:",s),O.error("Failed to archive assets.")},onFinish:()=>{ie(!1)}})},{isOpen:Qe,onOpen:Xe,onOpenChange:Ze}=T();return e.jsxs(ts,{children:[e.jsx(ss,{title:f}),e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:f}),e.jsx("p",{className:"text-gray-600 mb-4",children:m}),e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx(K,{isClearable:!0,className:"w-full sm:max-w-[44%]",placeholder:"Search by name, description...",startContent:e.jsx(ns,{className:"size-5"}),value:x,onClear:Pe,onChange:Me}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ls,{statuses:S,status:J,setStatus:De,descriptions:u,description:W,setDescription:be,issuedTos:g,issuedTo:Q,applyFilters:Re,setIssuedTo:Oe}),e.jsxs(ge,{children:[e.jsx(ve,{children:e.jsx(d,{variant:"bordered",children:"Filter by Date Issued"})}),e.jsx(_e,{"aria-label":"Filter by Date Issued",className:"p-2 w-72",closeOnSelect:!1,children:e.jsx(z,{className:"cursor-default",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(K,{type:"date",label:"Start Date",value:n,onChange:Ie}),e.jsx(K,{type:"date",label:"End Date",value:a,onChange:we}),e.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[e.jsx(d,{color:"primary",onPress:()=>M(n,a),children:"Apply"}),e.jsx(d,{color:"warning",variant:"flat",onPress:()=>{E(""),G(""),M("","")},children:"Clear"})]})]})},"filter")})]})]})]}),e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsx("div",{className:"flex justify-start items-center mb-4 gap-2",children:e.jsxs(xs,{children:[e.jsx(d,{color:"primary",as:je,variant:"flat",startContent:e.jsx(Ds,{className:"size-5"}),href:v("assetsextended.create"),children:"Add Asset"}),e.jsx(d,{color:"success",variant:"flat",startContent:e.jsx(bs,{className:"size-5"}),onPress:ze,isDisabled:y.size===0,children:"Transfer Asset"}),e.jsx(d,{color:"secondary",variant:"flat",startContent:e.jsx(as,{className:"size-5"}),onPress:Ye,isDisabled:y.size===0,children:"Declassification"})]})}),e.jsxs(ps,{isCompact:!0,isHeaderSticky:!0,isVirtualized:!0,maxTableHeight:"calc(100vh - 300px)",selectionMode:"multiple",selectedKeys:y,onSelectionChange:I,"aria-label":"Employee Assets table",isStriped:!0,children:[e.jsxs(ms,{className:"sticky top-0 bg-white z-10",children:[e.jsx(_,{children:"Asset #"}),e.jsx(_,{children:"System Asset ID"}),e.jsx(_,{children:"Description"}),e.jsx(_,{children:"Model"}),e.jsx(_,{children:"Serial No"}),e.jsxs(_,{onClick:Fe,style:{cursor:"pointer"},children:["EMPLOYEE",c==="name_asc"&&" 🔼",c==="name_desc"&&" 🔽",!["name_asc","name_desc"].includes(c)&&" ⏺️"]}),e.jsx(_,{children:"Location"}),e.jsx(_,{children:"Status"}),e.jsx(_,{children:"Date Issued"}),e.jsx(_,{children:"Actions"})]}),e.jsx(fs,{emptyContent:"No rows to display.",children:l.filter(t=>t.asset_details.some(s=>parseInt(s.archived)===0)).map(t=>t.asset_details.filter(s=>parseInt(s.archived)===0).map((s,R)=>{var D,k,de,he,ue,xe,pe,me,fe;return e.jsxs(js,{children:[e.jsx(N,{children:(D=s.ASSETNUMBER)==null?void 0:D.trim()}),e.jsx(N,{children:(k=s.SYSTEMASSETID)==null?void 0:k.trim()}),e.jsx(N,{children:(de=s.DESCRIPTION)==null?void 0:de.trim()}),e.jsx(N,{children:(he=s.MODEL)==null?void 0:he.trim()}),e.jsx(N,{children:(ue=s.SERIALNO)==null?void 0:ue.trim()}),e.jsx(N,{children:(xe=t.EMPLOYEENAME)==null?void 0:xe.trim()}),e.jsx(N,{children:(pe=s==null?void 0:s.location.LOCATIONNAME)==null?void 0:pe.trim()}),e.jsx(N,{children:e.jsx(Ss,{variant:"flat",color:cs[(me=s.STATUS)==null?void 0:me.trim()]||"default",radius:"md",children:(fe=s.STATUS)==null?void 0:fe.trim()})}),e.jsx(N,{children:s.DATEISSUUED?new Date(s.DATEISSUUED.trim()).toLocaleDateString():"--"}),e.jsx(N,{children:e.jsxs(ge,{children:[e.jsx(ve,{children:e.jsx(d,{isIconOnly:!0,size:"sm",variant:"light",children:e.jsx(is,{size:20,className:"text-default-800"})})}),e.jsxs(_e,{children:[e.jsx(z,{onPress:()=>{X({...t,asset_details:[s]}),ye()},children:"View"},"view"),e.jsx(z,{as:je,href:v("assetsextended.edit",s.ASSETNO),children:"Update"},"update"),e.jsx(z,{className:"text-danger",color:"danger",onPress:()=>{X({...t,asset_details:[s]}),Ke()},children:"Dispose"},"dispose")]})]})})]},s.ASSETNO)}))})]})]}),e.jsx(gs,{selectedAsset:$,isOpen:Ee,onOpenChange:Te,onComponentModalOpen:Xe}),e.jsx(os,{onComponentModalOpenChange:Ze,selectedAsset:$,isComponentModalOpen:Qe}),e.jsx(vs,{isTransferOpen:ke,onTransferOpenChange:Ue,employees:h,location:j,selectedEmployeeId:Be,setSelectedEmployeeId:se,selectedLocationId:Z,setSelectedLocationId:P,statusToTransfer:w,setStatusToTransfer:L,newStatus:q,selectedKeys:y,handleTransferAssets:Ge,loading:ee}),e.jsx(Ns,{location:j,selectedLocationId:Z,setSelectedLocationId:P,statusToTransfer:w,setStatusToTransfer:L,newStatus:q,selectedKeys:y,isDeclassificationOpen:Ve,onDeclassificationOpenChange:He,handleDeclassification:$e,loading:ee}),e.jsx(_s,{isArchiveOpen:qe,onArchiveOpenChange:We,reason:te,setReason:ae,statusToArchive:oe,setStatusToArchive:ce,condition:re,setCondition:ne,handleArchiveAssets:Je,loading:le,selectedAsset:$,archiveLoading:le,newStatus:q})]})]})}export{Xs as default};
