import{r as s,t as P,a as U,ab as S,a7 as k,g as N,j as I}from"./app-aY9BIasm.js";function q(...t){return t.length===1&&t[0]?t[0]:a=>{for(let e of t)typeof e=="function"?e(a):e!=null&&(e.current=a)}}function Q(t){const a=s.useRef(null);return s.useMemo(()=>({get current(){return a.current},set current(e){a.current=e,typeof t=="function"?t(e):t&&(t.current=e)}}),[t])}function te(t,a,e){let[l,d]=s.useState(t||a),i=s.useRef(t!==void 0),r=t!==void 0;s.useEffect(()=>{let o=i.current;o!==r&&console.warn(`WARN: A component changed from ${o?"controlled":"uncontrolled"} to ${r?"controlled":"uncontrolled"}.`),i.current=r},[r]);let n=r?t:l,u=s.useCallback((o,...c)=>{let v=(m,...$)=>{e&&(Object.is(n,m)||e(m,...$)),r||(n=m)};typeof o=="function"?(console.warn("We can not support a function callback. See Github Issues for details https://github.com/adobe/react-spectrum/issues/2320"),d(($,...V)=>{let b=o(r?n:$,...V);return v(b,...c),r?$:b})):(r||d(o),v(o,...c))},[r,n,e]);return[n,u]}var W=P({base:"flex flex-col gap-2 items-start"});const L={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},R={...L,customError:!0,valid:!1},y={isInvalid:!1,validationDetails:L,validationErrors:[]},O=s.createContext({}),D="__formValidationState"+Date.now();function ae(t){if(t[D]){let{realtimeValidation:a,displayValidation:e,updateValidation:l,resetValidation:d,commitValidation:i}=t[D];return{realtimeValidation:a,displayValidation:e,updateValidation:l,resetValidation:d,commitValidation:i}}return G(t)}function G(t){let{isInvalid:a,validationState:e,name:l,value:d,builtinValidation:i,validate:r,validationBehavior:n="aria"}=t;e&&(a||(a=e==="invalid"));let u=a!==void 0?{isInvalid:a,validationErrors:[],validationDetails:R}:null,o=s.useMemo(()=>{if(!r||d==null)return null;let f=K(r,d);return A(f)},[r,d]);i!=null&&i.validationDetails.valid&&(i=void 0);let c=s.useContext(O),v=s.useMemo(()=>l?Array.isArray(l)?l.flatMap(f=>C(c[f])):C(c[l]):[],[c,l]),[m,$]=s.useState(c),[V,b]=s.useState(!1);c!==m&&($(c),b(!1));let p=s.useMemo(()=>A(V?[]:v),[V,v]),w=s.useRef(y),[x,h]=s.useState(y),E=s.useRef(y),T=()=>{if(!B)return;g(!1);let f=o||i||w.current;M(f,E.current)||(E.current=f,h(f))},[B,g]=s.useState(!1);return s.useEffect(T),{realtimeValidation:u||p||o||i||y,displayValidation:n==="native"?u||p||x:u||p||o||i||x,updateValidation(f){n==="aria"&&!M(x,f)?h(f):w.current=f},resetValidation(){let f=y;M(f,E.current)||(E.current=f,h(f)),n==="native"&&g(!1),b(!0)},commitValidation(){n==="native"&&g(!0),b(!0)}}}function C(t){return t?Array.isArray(t)?t:[t]:[]}function K(t,a){if(typeof t=="function"){let e=t(a);if(e&&typeof e!="boolean")return C(e)}return[]}function A(t){return t.length?{isInvalid:!0,validationErrors:t,validationDetails:R}:null}function M(t,a){return t===a?!0:!!t&&!!a&&t.isInvalid===a.isInvalid&&t.validationErrors.length===a.validationErrors.length&&t.validationErrors.every((e,l)=>e===a.validationErrors[l])&&Object.entries(t.validationDetails).every(([e,l])=>a.validationDetails[e]===l)}function ie(...t){let a=new Set,e=!1,l={...L};for(let r of t){var d,i;for(let n of r.validationErrors)a.add(n);e||(e=r.isInvalid);for(let n in l)(d=l)[i=n]||(d[i]=r.validationDetails[n])}return l.valid=!e,{isInvalid:e,validationErrors:[...a],validationDetails:l}}function le(t,a,e){let{validationBehavior:l,focus:d}=t;U(()=>{if(l==="native"&&(e!=null&&e.current)&&!e.current.disabled){let u=a.realtimeValidation.isInvalid?a.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";e.current.setCustomValidity(u),e.current.hasAttribute("title")||(e.current.title=""),a.realtimeValidation.isInvalid||a.updateValidation(_(e.current))}});let i=S(()=>{a.resetValidation()}),r=S(u=>{var o;a.displayValidation.isInvalid||a.commitValidation();let c=e==null||(o=e.current)===null||o===void 0?void 0:o.form;if(!u.defaultPrevented&&e&&c&&z(c)===e.current){var v;d?d():(v=e.current)===null||v===void 0||v.focus(),k("keyboard")}u.preventDefault()}),n=S(()=>{a.commitValidation()});s.useEffect(()=>{let u=e==null?void 0:e.current;if(!u)return;let o=u.form;return u.addEventListener("invalid",r),u.addEventListener("change",n),o==null||o.addEventListener("reset",i),()=>{u.removeEventListener("invalid",r),u.removeEventListener("change",n),o==null||o.removeEventListener("reset",i)}},[e,r,n,i,l])}function Y(t){let a=t.validity;return{badInput:a.badInput,customError:a.customError,patternMismatch:a.patternMismatch,rangeOverflow:a.rangeOverflow,rangeUnderflow:a.rangeUnderflow,stepMismatch:a.stepMismatch,tooLong:a.tooLong,tooShort:a.tooShort,typeMismatch:a.typeMismatch,valueMissing:a.valueMissing,valid:a.valid}}function _(t){return{isInvalid:!t.validity.valid,validationDetails:Y(t),validationErrors:t.validationMessage?[t.validationMessage]:[]}}function z(t){for(let a=0;a<t.elements.length;a++){let e=t.elements[a];if(!e.validity.valid)return e}return null}var j=Symbol("default");function H(t,a){let e=s.useContext(t);if(a===null)return null;if(e&&typeof e=="object"&&"slots"in e&&e.slots){let l=new Intl.ListFormat().format(Object.keys(e.slots).map(i=>`"${i}"`));if(!a&&!e.slots[j])throw new Error(`A slot prop is required. Valid slot names are ${l}.`);let d=a||j;if(!e.slots[d])throw new Error(`Invalid slot "${a}". Valid slot names are ${l}.`);return e.slots[d]}return e}function J(t,a,e){let l=H(e,t.slot)||{},{ref:d,...i}=l,r=Q(s.useMemo(()=>q(a,d),[a,d])),n=N(i,t);return"style"in i&&i.style&&"style"in t&&t.style&&(typeof i.style=="function"||typeof t.style=="function"?n.style=u=>{let o=typeof i.style=="function"?i.style(u):i.style,c={...u.defaultStyle,...o},v=typeof t.style=="function"?t.style({...u,defaultStyle:c}):t.style;return{...c,...v}}:n.style={...i.style,...t.style}),[n,r]}var F=s.createContext(null),re=s.forwardRef(function(a,e){[a,e]=J(a,e,F);let{validationErrors:l,validationBehavior:d="native",children:i,className:r,...n}=a;const u=s.useMemo(()=>W({className:r}),[r]);return I.jsx("form",{noValidate:d!=="native",...n,ref:e,className:u,children:I.jsx(F.Provider,{value:{...a,validationBehavior:d},children:I.jsx(O.Provider,{value:l??{},children:i})})})});export{te as $,F,ae as a,D as b,q as c,re as d,le as e,y as f,ie as g,L as h,H as u};
